<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF Maker | Multi-Tools</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <div id="ad-placeholder"></div>

    <div class="container my-4">
        <div class="row">
            <div class="col-lg-8 mb-4">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h1 class="card-title mb-4"><i class="fas fa-magic text-primary"></i> GIF Maker</h1>
                        <div id="tool-ui">
                            <div class="mb-3">
                                <label for="imageInput" class="form-label">1. Upload Images</label>
                                <input type="file" class="form-control" id="imageInput" multiple accept="image/*">
                                <small class="form-text text-muted">Select multiple images to create your animated GIF.</small>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="frameDelay" class="form-label">2. Frame Delay (ms)</label>
                                    <input type="number" class="form-control" id="frameDelay" value="500" min="100" max="5000" step="100">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="gifQuality" class="form-label">3. GIF Quality</label>
                                    <select class="form-select" id="gifQuality">
                                        <option value="1">Best (Larger file)</option>
                                        <option value="10" selected>Medium</option>
                                        <option value="20">Low (Smaller file)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="d-flex gap-2 mb-3">
                                <button class="btn btn-primary" id="createGifBtn"><i class="fas fa-play"></i> Create GIF</button>
                                <button class="btn btn-outline-secondary" id="clearImagesBtn"><i class="fas fa-trash"></i> Clear Images</button>
                            </div>
                            
                            <div id="progress-container" class="mb-3" style="display: none;">
                                <div class="progress">
                                    <div class="progress-bar" id="gif-progress" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                </div>
                            </div>
                            
                            <div id="imagePreview" class="mb-3 p-2 border rounded bg-light d-flex flex-wrap gap-2" style="min-height: 120px;">
                                <!-- Image previews will be shown here -->
                            </div>
                            
                            <div id="gifResult" class="mb-3" style="display: none;">
                                <h5>Your GIF is Ready!</h5>
                                <img id="generatedGif" class="img-fluid border rounded shadow-sm" alt="Generated GIF">
                                <div class="mt-2">
                                    <button class="btn btn-success" id="downloadGifBtn"><i class="fas fa-download"></i> Download GIF</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                 <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-info-circle"></i> How to Use
                        </h5>
                        <ol class="list-group list-group-flush">
                            <li class="list-group-item">Upload one or more images.</li>
                            <li class="list-group-item">Set the delay (speed) between frames.</li>
                            <li class="list-group-item">Choose your desired GIF quality.</li>
                            <li class="list-group-item">Click "Create GIF" and wait a moment.</li>
                            <li class="list-group-item">Download your creation!</li>
                        </ol>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Related Tools</h5>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item"><a href="image-resizer.html">Image Resizer</a></li>
                            <li class="list-group-item"><a href="image-compressor.html">Image Compressor</a></li>
                            <li class="list-group-item"><a href="video-converter.html">Video Converter</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div> 

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <script src="main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let uploadedImages = [];
            let generatedGifBlob = null;

            const imageInput = document.getElementById('imageInput');
            const imagePreview = document.getElementById('imagePreview');
            const createGifBtn = document.getElementById('createGifBtn');
            const clearImagesBtn = document.getElementById('clearImagesBtn');
            const gifResult = document.getElementById('gifResult');
            const generatedGif = document.getElementById('generatedGif');
            const downloadGifBtn = document.getElementById('downloadGifBtn');

            imageInput.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                uploadedImages = [];
                imagePreview.innerHTML = '';
                gifResult.style.display = 'none';

                files.forEach((file) => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const img = new Image();
                            img.src = e.target.result;
                            img.className = 'img-thumbnail';
                            img.style.width = '100px';
                            img.style.height = '100px';
                            img.style.objectFit = 'cover';
                            uploadedImages.push(img);
                            imagePreview.appendChild(img);
                        };
                        reader.readAsDataURL(file);
                    }
                });
            });

            createGifBtn.addEventListener('click', function() {
                if (uploadedImages.length < 1) {
                    alert('Please upload at least 1 image to create a GIF.');
                    return;
                }

                createGifBtn.disabled = true;
                createGifBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Creating...';
                document.getElementById('progress-container').style.display = 'block';
                const progressBar = document.getElementById('gif-progress');

                const frameDelay = parseInt(document.getElementById('frameDelay').value, 10);
                const gifQuality = parseInt(document.getElementById('gifQuality').value, 10);
                
                const gif = new GIF({
                    workers: 2,
                    quality: gifQuality,
                    workerScript: 'https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js'
                });

                gif.on('progress', function(p) {
                    const progress = Math.round(p * 100);
                    progressBar.style.width = progress + '%';
                    progressBar.textContent = progress + '%';
                });

                uploadedImages.forEach(img => {
                    gif.addFrame(img, {delay: frameDelay});
                });

                gif.on('finished', function(blob) {
                    generatedGifBlob = blob;
                    const url = URL.createObjectURL(blob);
                    generatedGif.src = url;
                    gifResult.style.display = 'block';

                    createGifBtn.disabled = false;
                    createGifBtn.innerHTML = '<i class="fas fa-play"></i> Create GIF';
                    document.getElementById('progress-container').style.display = 'none';
                    progressBar.style.width = '0%';
                    progressBar.textContent = '0%';
                });

                try {
                    gif.render();
                } catch (error) {
                    console.error('Error rendering GIF:', error);
                    alert('An error occurred while creating the GIF. Please try again with different images or settings.');
                    createGifBtn.disabled = false;
                    createGifBtn.innerHTML = '<i class="fas fa-play"></i> Create GIF';
                    document.getElementById('progress-container').style.display = 'none';
                    progressBar.style.width = '0%';
                    progressBar.textContent = '0%';
                }
            });

            downloadGifBtn.addEventListener('click', function() {
                if (generatedGifBlob) {
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(generatedGifBlob);
                    a.download = 'made-with-multitools.gif';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                } else {
                    alert('Something went wrong. Please create the GIF again.');
                }
            });
            
            clearImagesBtn.addEventListener('click', function() {
                uploadedImages = [];
                generatedGifBlob = null;
                imageInput.value = '';
                imagePreview.innerHTML = '';
                gifResult.style.display = 'none';
            });
        });
    </script>
</body>
</html> 
